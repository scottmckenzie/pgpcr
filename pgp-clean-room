#!/usr/bin/python3

from snack import *
import subprocess, tempfile
from pgpcr import gpg_newt as gpg_ui, disks_newt as disks

screen = SnackScreen()
ret = ButtonChoiceWindow(screen,"Welcome to PGP Clean Room!", "What do you wish to do?", [("List Disks","disks"),("New GPG Key", "new gpg"), ("Load GPG Key","load gpg"), ("Run Shell","shell"), ("Quit", "quit")] )

workdir = tempfile.TemporaryDirectory(prefix="pgpcr")
if ret == "disks":
	disks.listdisks()
elif ret == "new gpg":
	gpg_ui.new(screen, workdir)
elif ret == "old gpg":
	gpg_ui.load(screen, workdir)
elif ret == "shell":
	screen.finish()
	subprocess.run(["/bin/bash", "-l"])
elif ret == "quit":
	screen.finish()
	subprocess.run(["/usr/bin/sudo", "shutdown", "now"])
